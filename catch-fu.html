<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ–°æ˜¥æ¥ç¦æ¸¸æˆ</title>
  <style>
    @font-face {
      font-family: 'KosefontJP';
      src: url('fonts/Kosefont-JP.ttf') format('truetype');
    }

    @font-face {
      font-family: 'KosefontPJP';
      src: url('fonts/KosefontP-JP.ttf') format('truetype');
    }

    /* åŸºç¡€æ ·å¼ */
    body {
      margin: 0;
      overflow: hidden;
      height: 100vh;
      font-family: 'KosefontJP', sans-serif;
      /* æ·»åŠ é»˜è®¤å­—ä½“ */
      /* ç¡®ä¿bodyå æ»¡æ•´ä¸ªè§†å£é«˜åº¦ */
    }

    #gameContainer {
      width: 700vw;
      height: 100vh;
      position: relative;
      overflow: hidden;
      margin-top: -60px;
      /* æŠµæ¶ˆæµè§ˆå™¨å¯¼èˆªæ çš„é«˜åº¦ */
      padding-top: 60px;
      /* æ·»åŠ å†…è¾¹è·ä»¥ä¿æŒå†…å®¹ä¸è¢«é®æŒ¡ */
    }

    /* æ·»åŠ èƒŒæ™¯å®¹å™¨æ ·å¼ */
    .background-container {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 0;
    }

    /* èƒŒæ™¯å›¾ç‰‡å®¹å™¨ */
    .background-section {
      position: absolute;
      width: 100vw;
      height: 140vh;
      background: url('images/shanshui.png') no-repeat center;
      background-size: 100vw 140vh;
      top: -30vh;
    }

    /* å®šä½7ä¸ªèƒŒæ™¯å›¾ç‰‡ */
    .background-container .background-section:nth-child(1) {
      left: 0;
    }

    .background-container .background-section:nth-child(2) {
      left: 100vw;
    }

    .background-container .background-section:nth-child(3) {
      left: 200vw;
    }

    .background-container .background-section:nth-child(4) {
      left: 300vw;
    }

    .background-container .background-section:nth-child(5) {
      left: 400vw;
    }

    .background-container .background-section:nth-child(6) {
      left: 500vw;
    }

    .background-container .background-section:nth-child(7) {
      left: 600vw;
    }

    /* ç©å®¶æ ·å¼ */
    #player {
      position: absolute;
      width: 100px;
      height: 100px;
      z-index: 1000;
      background: url('images/daimaoyou.png') no-repeat center/contain;
      top: 88vh;
    }

    /* ç¦å­—æ ·å¼ */
    .fu,
    .dafu,
    .caochonggun,
    .shuangdao,
    .dajian {
      position: absolute;
      width: 60px;
      height: 60px;
      animation: fall linear 4s;
      user-select: none;
      border-radius: 50%;
      z-index: 900;
    }

    .fu {
      background: url('images/fu1.png') no-repeat center/contain;
    }

    .dafu {
      background: url('images/dafu.png') no-repeat center/contain;
    }

    .caochonggun {
      background: url('images/caochonggun1.png') no-repeat center/contain;
    }

    .shuangdao {
      position: absolute;
      width: 60px;
      height: 60px;
      animation: fall linear 4s;
      user-select: none;
      border-radius: 50%;
      z-index: 900;
      background: url('images/shuangdao1.png') no-repeat center/contain;
    }

    .dajian {
      background: url('images/dajian1.png') no-repeat center/contain;
    }

    .zhongnu {
      position: absolute;
      width: 60px;
      height: 60px;
      animation: fall linear 4s;
      user-select: none;
      border-radius: 50%;
      z-index: 900;
      background: url('images/zhongnu1.png') no-repeat center/contain;
    }

    /* æ·»åŠ å¤ªåˆ€æ ·å¼ */
    .taidao {
      position: absolute;
      width: 60px;
      height: 60px;
      animation: fall linear 4s;
      user-select: none;
      border-radius: 50%;
      z-index: 900;
      background: url('images/taidao1.png') no-repeat center/contain;
    }

    @keyframes fall {
      from {
        top: -60px;
      }

      to {
        top: 100vh;
      }
    }

    /* è¿”å›æŒ‰é’®æ ·å¼ */
    .back-button {
      position: fixed;
      top: 20px;
      left: 20px;
      padding: 10px 20px;
      background-color: rgba(142, 207, 206, 0.9);
      border-radius: 10px;
      text-decoration: none;
      color: #3CB371;
      /* æ”¹ä¸ºç¿¡ç¿ ç»¿è‰² */
      font-family: 'KosefontJP', sans-serif;
      z-index: 1000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      /* æ·»åŠ æ–‡å­—é˜´å½±æ•ˆæœ */
      text-shadow:
        2px 2px 0 #000,
        -2px -2px 0 #000,
        2px -2px 0 #000,
        -2px 2px 0 #000,
        0 2px 0 #000;
    }

    /* ç§¯åˆ†æ¡†æ ·å¼ */
    #scoreBox {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(142, 207, 206, 0.9);
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 24px;
      font-family: 'KosefontPJP', sans-serif;
      z-index: 2000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      /* æ·»åŠ æ–‡å­—æ•ˆæœ */
      text-shadow:
        2px 2px 0 #000,
        -2px -2px 0 #000,
        2px -2px 0 #000,
        -2px 2px 0 #000,
        0 2px 0 #000,
        2px 0 0 #000;
      color: #3CB371;
      /* ç¿¡ç¿ ç»¿è‰² */
    }

    #scoreValue {
      color: #FF4D4D;
      font-weight: bold;
      text-shadow:
        2px 2px 0 #000,
        -2px -2px 0 #000,
        2px -2px 0 #000,
        -2px 2px 0 #000;
    }

    /* åœ¨styleæ ‡ç­¾ä¸­æ·»åŠ çŠ¶æ€æ æ ·å¼ */
    #statusBar {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(142, 207, 206, 0.9);
      padding: 10px;
      border-radius: 10px;
      display: flex;
      gap: 10px;
      z-index: 2000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .status-icon {
      width: 40px;
      height: 40px;
      position: relative;
      opacity: 0.5;
      /* æœªæ¿€æ´»æ—¶åŠé€æ˜ */
    }

    .status-icon.active {
      opacity: 1;
      /* æ¿€æ´»æ—¶å®Œå…¨ä¸é€æ˜ */
    }

    .status-icon img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .tooltip {
      position: relative;
    }

    .tooltip::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      padding: 5px 10px;
      background: rgba(0, 0, 0, 0.8);
      color: #00BFFF;
      border-radius: 5px;
      font-size: 14px;
      white-space: nowrap;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s;
      text-shadow: 1px 1px 0 #000;
      margin-bottom: 5px;
    }

    .tooltip:hover::after {
      visibility: visible;
      opacity: 1;
    }

    /* åœ¨styleæ ‡ç­¾ä¸­æ·»åŠ å¸å–åŠ¨ç”» */
    @keyframes attract {
      to {
        transform: scale(0.5);
        opacity: 0.7;
      }
    }

    /* åœ¨ style æ ‡ç­¾ä¸­æ·»åŠ è®¡æ—¶å™¨æ ·å¼ */
    #timerBox {
      position: fixed;
      top: 20px;
      right: 50%;
      transform: translateX(50%);
      background: rgba(142, 207, 206, 0.9);
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 24px;
      font-family: 'KosefontPJP', sans-serif;
      z-index: 2000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      margin-right: -200px;
      /* æ·»åŠ æ–‡å­—æ•ˆæœ */
      text-shadow:
        2px 2px 0 #000,
        -2px -2px 0 #000,
        2px -2px 0 #000,
        -2px 2px 0 #000,
        0 2px 0 #000,
        2px 0 0 #000,
        0 -2px 0 #000,
        -2px 0 0 #000;
      color: #3CB371;
    }

    #timerValue {
      color: #FF4D4D;
      font-weight: bold;
      text-shadow:
        2px 2px 0 #000,
        -2px -2px 0 #000,
        2px -2px 0 #000,
        -2px 2px 0 #000;
    }

    /* ä¿®æ”¹æ¸¸æˆç»“æŸå¼¹çª—æ ·å¼ */
    #gameOverModal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      /* ä½¿ç”¨è§†å£é«˜åº¦ */
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow-y: auto;
      /* å…è®¸å†…å®¹æ»šåŠ¨ */
    }

    #gameOverModal h2 {
      color: #FF4D4D;
      margin: 20px 0;
      font-size: 36px;
      text-shadow:
        2px 2px 0 #000,
        -2px -2px 0 #000,
        2px -2px 0 #000,
        -2px 2px 0 #000;
    }

    /* ä¿®æ”¹å¥–åŠ±è§†é¢‘å®¹å™¨æ ·å¼ */
    #rewardVideos {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      width: 80%;
      /* å¢åŠ å®½åº¦ä»¥å®¹çº³æ›´å¤šæŒ‰é’® */
      margin: 20px auto;
      padding: 20px;
      max-height: 70vh;
      /* é™åˆ¶æœ€å¤§é«˜åº¦ */
      overflow-y: auto;
      /* æ·»åŠ æ»šåŠ¨æ¡ */
    }

    /* æ·»åŠ æ»šåŠ¨æ¡æ ·å¼ */
    #rewardVideos::-webkit-scrollbar {
      width: 8px;
    }

    #rewardVideos::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }

    #rewardVideos::-webkit-scrollbar-thumb {
      background: rgba(142, 207, 206, 0.6);
      border-radius: 4px;
    }

    #rewardVideos::-webkit-scrollbar-thumb:hover {
      background: rgba(142, 207, 206, 0.8);
    }

    /* ä¿®æ”¹æŒ‰é’®æ ·å¼ */
    a.aki-btn {
      text-decoration: none;
      line-height: 1.2;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      width: 220px;
      height: 60px;
      background: linear-gradient(90deg, rgba(142, 207, 206, 0.9), rgba(255, 255, 255, 0.9));
      border-radius: 12px;
      font-size: 18px;
      color: #000;
      overflow: hidden;
      position: relative;
      margin: 10px auto;
      box-shadow: 0 4px 8px rgba(255, 77, 77, 0.3);
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }

    a.aki-btn span.icon,
    a.aki-btn span.txt {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      color: white;
      transition: all 0.5s ease;
      z-index: 2;
      backface-visibility: hidden;
    }

    a.aki-btn span.txt {
      transform: rotateY(0deg);
    }

    a.aki-btn span.icon {
      transform: rotateY(-180deg);
    }

    a.aki-btn span.icon svg {
      width: 30px;
      fill: #fff;
    }

    a.aki-btn:hover span.txt {
      transform: rotateY(-180deg);
    }

    a.aki-btn:hover span.icon {
      transform: rotateY(0deg);
    }

    /* ä¿®æ”¹è¿›åº¦æ–‡æœ¬æ ·å¼ */
    .progress-text {
      color: #FFD700;
      font-size: 14px;
      /* å‡å°å­—ä½“å¤§å° */
      margin-top: 5px;
      text-shadow:
        1px 1px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000;
    }

    /* ä¿®æ”¹åº•éƒ¨æŒ‰é’®å®¹å™¨æ ·å¼ */
    .bottom-buttons {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      width: 60%;
      margin: 20px auto;
      margin-left: 230px;
      /* ä½¿ç”¨margin-leftæ¥è°ƒæ•´ä½ç½® */
    }

    /* ä¿®æ”¹åº•éƒ¨æŒ‰é’®æ ·å¼ */
    .bottom-buttons .aki-btn {
      /* åªé€‰æ‹©åº•éƒ¨æŒ‰é’®å®¹å™¨ä¸­çš„æŒ‰é’® */
      background: linear-gradient(90deg, rgba(255, 77, 77, 0.9), rgba(255, 179, 179, 0.9));
      color: white;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
      box-shadow: 0 4px 8px rgba(255, 77, 77, 0.3);
    }

    /* æ·»åŠ æ‚¬åœæ•ˆæœ */
    .bottom-buttons .aki-btn:hover {
      background: linear-gradient(90deg, rgba(255, 51, 51, 0.9), rgba(255, 153, 153, 0.9));
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(255, 77, 77, 0.4);
    }

    /* éšè—UIå…ƒç´  */
    .hide-ui {
      display: none;
    }

    /* è§†é¢‘æŒ‰é’®æ ·å¼æ¢å¤åŸæ¥çš„é¢œè‰² */
    #rewardVideos .aki-btn {
      background: linear-gradient(90deg, rgba(142, 207, 206, 0.9), rgba(255, 255, 255, 0.9));
      color: #000;
    }

    /* åº•éƒ¨æŒ‰é’®ä¿æŒçº¢è‰² */
    .bottom-buttons .aki-btn {
      background: linear-gradient(90deg, rgba(255, 77, 77, 0.9), rgba(255, 179, 179, 0.9));
      color: white;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
      box-shadow: 0 4px 8px rgba(255, 77, 77, 0.3);
    }

    .bottom-buttons .aki-btn:hover {
      background: linear-gradient(90deg, rgba(255, 51, 51, 0.9), rgba(255, 153, 153, 0.9));
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(255, 77, 77, 0.4);
    }

    /* è§†é¢‘æ’­æ”¾å™¨æ ·å¼ */
    #videoPlayer {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-radius: 10px;
      z-index: 1000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    #videoPlayer video {
      width: 100%;
      max-width: 800px;
      border-radius: 5px;
    }

    #videoPlayer .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
    }

    #videoPlayer .controls button {
      background: none;
      border: none;
      color: #00BFFF;
      cursor: pointer;
      font-size: 24px;
      text-shadow:
        1px 1px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000;
    }

    #videoPlayer .controls .progress {
      flex-grow: 1;
      margin: 0 10px;
      position: relative;
      height: 10px;
      background: #333;
      border-radius: 5px;
      cursor: pointer;
      overflow: visible;
      /* ç¡®ä¿å‘†çŒ«å›¾ç‰‡ä¸ä¼šè¢«è£å‰ª */
    }

    #videoPlayer .controls .progress .thumb {
      width: 20px;
      height: 20px;
      background: #FFD700;
      border-radius: 50%;
      position: absolute;
      top: 50%;
      left: 0;
      transform: translateY(-50%);
      cursor: pointer;
    }

    #videoPlayer .controls .time {
      color: #FFD700;
      font-size: 14px;
      text-shadow:
        1px 1px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000;
    }

    #videoPlayer .controls .volume {
      display: flex;
      align-items: center;
    }

    #videoPlayer .controls .volume input[type="range"] {
      -webkit-appearance: none;
      width: 100px;
      height: 5px;
      background: #333;
      border-radius: 5px;
      margin-left: 10px;
    }

    #videoPlayer .controls .volume input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 15px;
      height: 15px;
      background: #FFD700;
      border-radius: 50%;
      cursor: pointer;
    }

    #videoPlayer .controls .volume input[type="range"]::-webkit-slider-runnable-track {
      -webkit-appearance: none;
      background: #333;
      border-radius: 5px;
    }

    #videoPlayer .controls .speed {
      position: relative;
    }

    #videoPlayer .controls .speed .speed-menu {
      display: none;
      position: absolute;
      bottom: 100%;
      background: rgba(47, 79, 79, 0.9);
      border-radius: 5px;
      padding: 5px;
    }

    #videoPlayer .controls .speed .speed-option {
      color: #00BFFF;
      text-shadow:
        1px 1px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000;
      cursor: pointer;
      /* æ”¹ä¸ºæ‰‹å‹å…‰æ ‡ */
      text-align: center;
      white-space: nowrap;
      text-shadow: 1px 1px 0 #000;
    }

    #videoPlayer .controls .speed:hover .speed-menu {
      display: block;
    }

    #videoPlayer .controls .save {
      background: none;
      border: none;
      color: #FFD700;
      cursor: pointer;
      font-size: 14px;
      text-shadow:
        1px 1px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000;
    }

    #videoPlayer .controls .close {
      background: none;
      border: none;
      color: #FFD700;
      cursor: pointer;
      font-size: 24px;
      text-shadow:
        1px 1px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000;
    }

    /* æ·»åŠ å€é€Ÿé€‰é¡¹çš„æ‚¬åœæ•ˆæœ */
    .speed-option:hover {
      background: rgba(0, 191, 255, 0.2);
    }

    /* ä¿®æ”¹å€é€Ÿæ˜¾ç¤ºéƒ¨åˆ† */
    #currentSpeed {
      color: #00BFFF;
      text-shadow: 1px 1px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000;
      margin-right: 5px;
      cursor: pointer;
      position: relative;
      display: inline-block;
      padding: 2px 5px;
    }

    /* ç¡®ä¿ tooltip æ ·å¼æ­£ç¡® */
    .tooltip {
      position: relative;
    }

    .tooltip::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      padding: 5px 10px;
      background: rgba(0, 0, 0, 0.8);
      color: #00BFFF;
      border-radius: 5px;
      font-size: 14px;
      white-space: nowrap;
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.3s;
      text-shadow: 1px 1px 0 #000;
      margin-bottom: 5px;
      z-index: 3002;
    }

    .tooltip:hover::after {
      visibility: visible;
      opacity: 1;
    }

    /* æ·»åŠ é¼ æ ‡æ‚¬åœæ•ˆæœ */
    #currentSpeed:hover {
      background: rgba(0, 191, 255, 0.2);
      border-radius: 3px;
    }

    /* æ·»åŠ å€é€Ÿé€‰é¡¹çš„æ ·å¼ */
    .speed-menu {
      display: none;
      position: absolute;
      bottom: 120%;
      /* å¢åŠ ä¸æŒ‰é’®çš„è·ç¦»ï¼Œé¿å…è¢«tooltipé®æŒ¡ */
      left: 50%;
      transform: translateX(-50%);
      background: rgba(47, 79, 79, 0.9);
      border-radius: 5px;
      padding: 5px;
      z-index: 3003;
      /* ç¡®ä¿åœ¨tooltipä¹‹ä¸Š */
    }

    .speed-option {
      color: #00BFFF;
      /* ä½¿ç”¨äº®è“è‰² */
      padding: 5px 15px;
      cursor: pointer;
      /* æ”¹ä¸ºæ‰‹å‹å…‰æ ‡ */
      text-align: center;
      white-space: nowrap;
      text-shadow: 1px 1px 0 #000;
    }

    .speed-option:hover {
      background: rgba(0, 191, 255, 0.2);
      /* é¼ æ ‡æ‚¬åœæ—¶çš„èƒŒæ™¯è‰² */
      border-radius: 3px;
    }

    /* å½“å‰é€Ÿåº¦æ˜¾ç¤ºæ ·å¼ */
    #currentSpeed {
      color: #00BFFF;
      /* ä½¿ç”¨äº®è“è‰² */
      text-shadow: 1px 1px 0 #000;
      cursor: pointer;
      padding: 2px 5px;
      border-radius: 3px;
    }

    #currentSpeed:hover {
      background: rgba(0, 191, 255, 0.2);
    }

    /* éŸ³é¢‘æ’­æ”¾å™¨æ ·å¼ */
    .music-player {
      position: fixed;
      top: 20px;
      left: 250px;
      /* æ”¹ä¸ºå·¦ä¾§å®šä½ */
      text-align: center;
      z-index: 1001;
      display: flex;
      flex-direction: column;
      /* æ”¹ä¸ºçºµå‘æ’åˆ— */
      align-items: center;
    }

    /* æ’­æ”¾å™¨å›¾ç‰‡åŸºç¡€æ ·å¼ */
    .player-image {
      width: 60px;
      /* å¢å¤§å°ºå¯¸ */
      height: 60px;
      border-radius: 50%;
      border: 2px solid #005bb5;
      transition: transform 0.5s ease-out;
      cursor: pointer;
      transform-origin: center;
    }

    /* æ’­æ”¾å™¨æ–‡å­—æ ·å¼è°ƒæ•´ */
    .player-text {
      margin: 5px 0 0 0;
      color: #03e9f4;
      font-family: 'KosefontJP', Arial, sans-serif;
      font-size: 14px;
      text-shadow: 0 0 10px rgba(3, 233, 244, 0.3);
      white-space: nowrap;
      opacity: 0;
      /* é»˜è®¤éšè— */
      transition: opacity 0.3s ease;
    }

    /* é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºæ–‡å­— */
    .music-player:hover .player-text {
      opacity: 1;
    }

    /* æ’­æ”¾æ—¶çš„æ—‹è½¬åŠ¨ç”» */
    .player-image.playing {
      animation: rotate 5s linear infinite;
    }

    @keyframes rotate {
      from {
        transform: rotate(var(--rotation));
      }

      to {
        transform: rotate(calc(var(--rotation) + 360deg));
      }
    }

    /* æ’­æ”¾å™¨å›¾ç‰‡åŸºç¡€æ ·å¼ */
    .player-image {
      width: 60px;
      /* å¢å¤§å°ºå¯¸ */
      height: 60px;
      border-radius: 50%;
      border: 2px solid #005bb5;
      transition: transform 0.5s ease-out;
      cursor: pointer;
      transform-origin: center;
    }

    /* æ’­æ”¾å™¨æ–‡å­—æ ·å¼è°ƒæ•´ */
    .player-text {
      margin: 5px 0 0 0;
      color: #03e9f4;
      font-family: 'KosefontJP', Arial, sans-serif;
      font-size: 14px;
      text-shadow: 0 0 10px rgba(3, 233, 244, 0.3);
      white-space: nowrap;
      opacity: 0;
      /* é»˜è®¤éšè— */
      transition: opacity 0.3s ease;
    }

    /* é¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºæ–‡å­— */
    .music-player:hover .player-text {
      opacity: 1;
    }

    /* æ’­æ”¾æ—¶çš„æ—‹è½¬åŠ¨ç”» */
    .player-image.playing {
      animation: rotate 5s linear infinite;
    }

    @keyframes rotate {
      from {
        transform: rotate(var(--rotation));
      }

      to {
        transform: rotate(calc(var(--rotation) + 360deg));
      }
    }

    /* ä¿®æ”¹ç»“æŸæŒ‰é’®æ ·å¼ï¼Œè°ƒæ•´ä½ç½® */
    #endGameButton {
      position: fixed;
      top: 20px;
      left: 120px;
      transform: translateX(50%);
      /* å‘å³ç§»åŠ¨è‡ªèº«å®½åº¦çš„ä¸€åŠ */
      background: rgba(142, 207, 206, 0.9);
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 24px;
      font-family: 'KosefontPJP', sans-serif;
      z-index: 2000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      border: none;
      cursor: pointer;
      margin-left: 200px;
      /* æ·»åŠ å·¦è¾¹è· */
      /* æ·»åŠ æ–‡å­—æ•ˆæœ */
      text-shadow:
        2px 2px 0 #000,
        -2px -2px 0 #000,
        2px -2px 0 #000,
        -2px 2px 0 #000,
        0 2px 0 #000,
        2px 0 0 #000;
      color: #FF4D4D;
      /* ä½¿ç”¨çº¢è‰²ä»¥ç¤ºè­¦å‘Š */
    }

    #endGameButton:hover {
      background: rgba(255, 77, 77, 0.9);
      color: white;
    }

    /* æ¸¸æˆè§„åˆ™æ ·å¼ */
    .game-rules {
      position: fixed;
      top: 80px;
      left: 20px;
      z-index: 2000;
      width: 200px;
      background: rgba(142, 207, 206, 0.9);
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      overflow: hidden;
    }

    .game-rules:hover {
      width: 400px;
      background: rgba(142, 207, 206, 0.95);
    }

    .rules-header {
      padding: 10px 20px;
      color: #3CB371;
      font-family: 'KosefontPJP', sans-serif;
      font-size: 20px;
      cursor: pointer;
      text-shadow:
        2px 2px 0 #000,
        -2px -2px 0 #000,
        2px -2px 0 #000,
        -2px 2px 0 #000;
    }

    .rules-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease-out;
      padding: 0 20px;
    }

    .game-rules:hover .rules-content {
      max-height: 800px;
      padding-bottom: 20px;
    }

    .rules-intro {
      color: #FF4D4D;
      margin: 10px 0;
      font-size: 16px;
      line-height: 1.4;
      text-shadow:
        1px 1px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000;
    }

    .rules-items {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .rule-item {
      display: flex;
      align-items: center;
      gap: 10px;
      background: rgba(255, 255, 255, 0.1);
      padding: 8px;
      border-radius: 8px;
    }

    .rule-item img {
      width: 30px;
      height: 30px;
      object-fit: contain;
    }

    .rule-item span {
      color: #00BFFF;
      font-size: 14px;
      line-height: 1.3;
      text-shadow:
        1px 1px 0 #000,
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000;
    }

    /* æ·»åŠ åŠ¨ç”»æ•ˆæœ */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .game-rules:hover .rule-item {
      animation: fadeIn 0.3s ease-out forwards;
    }

    .rule-item:nth-child(1) {
      animation-delay: 0.1s;
    }

    .rule-item:nth-child(2) {
      animation-delay: 0.2s;
    }

    .rule-item:nth-child(3) {
      animation-delay: 0.3s;
    }

    .rule-item:nth-child(4) {
      animation-delay: 0.4s;
    }

    .rule-item:nth-child(5) {
      animation-delay: 0.5s;
    }

    .rule-item:nth-child(6) {
      animation-delay: 0.6s;
    }

    .rule-item:nth-child(7) {
      animation-delay: 0.7s;
    }

    /* ä¿®æ”¹ç®­å¤´å’Œæç¤ºæ–‡æœ¬çš„æ ·å¼ */
    .music-hint {
      position: fixed;
      top: 100px;
      left: 255px;
      display: flex;
      flex-direction: column;
      align-items: center;
      z-index: 1002;
      animation: float 2s ease-in-out infinite;
      /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
      transition: opacity 0.3s ease;
    }

    .music-hint::before {
      content: '';
      width: 4px;
      height: 40px;
      background-color: rgba(0, 191, 255, 0.9);
      margin-bottom: 10px;
      position: relative;
    }

    .music-hint::after {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 8px solid transparent;
      border-right: 8px solid transparent;
      border-bottom: 12px solid rgba(0, 191, 255, 0.9);
    }

    .music-hint-text {
      background: rgba(0, 191, 255, 0.9);
      color: #fff;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 14px;
      font-family: 'KosefontJP', Arial, sans-serif;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
      margin-bottom: 5px;
      width: 1.5em;
      /* è®¾ç½®å›ºå®šå®½åº¦é€‚åˆä¸€ä¸ªå­— */
      text-align: center;
      /* æ–‡å­—å±…ä¸­ */
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-10px);
      }
    }

    /* ä¿®æ”¹å‘†çŒ«å›¾ç‰‡çš„åŠ¨ç”»æ•ˆæœ */
    .progress-daimao {
      position: absolute;
      top: -50px;
      left: 0;
      width: 70px;
      height: 70px;
      transform: translateX(-50%);
      transition: left 0.1s linear;
      will-change: left, transform;
      animation: daimaoFloat 2s ease-in-out infinite;
      transform-origin: bottom center;
      /* è®¾ç½®æ—‹è½¬çš„åŸç‚¹åœ¨åº•éƒ¨ä¸­å¿ƒ */
    }

    /* æ·»åŠ å‘†çŒ«æµ®åŠ¨åŠ¨ç”» */
    @keyframes daimaoFloat {
      0% {
        transform: translateX(-50%) translateY(0) rotate(-5deg);
      }

      25% {
        transform: translateX(-50%) translateY(-15px) rotate(0deg);
      }

      50% {
        transform: translateX(-50%) translateY(0) rotate(5deg);
      }

      75% {
        transform: translateX(-50%) translateY(-15px) rotate(0deg);
      }

      100% {
        transform: translateX(-50%) translateY(0) rotate(-5deg);
      }
    }
  </style>
</head>

<body>
  <!-- åœ¨gameContainerä¹‹å‰æ·»åŠ è§†é¢‘æ’­æ”¾å™¨å®¹å™¨ -->
  <div id="rewardVideoContainer"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); z-index: 3000;">
    <video id="rewardVideo" style="width: 80%; max-height: 80vh; margin: 20px auto; display: block;">
      <source src="" type="video/mp4">
      æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
    </video>

    <!-- è‡ªå®šä¹‰è§†é¢‘æ§åˆ¶æ  -->
    <div class="custom-controls"
      style="position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 80%; background: rgba(47, 79, 79, 0.9); padding: 10px; border-radius: 10px; display: flex; align-items: center; gap: 10px;">
      <button id="playPauseBtn" class="tooltip" data-tooltip="æ’­æ”¾/æš‚åœ"
        style="background: none; border: none; color: #00BFFF; cursor: pointer; font-size: 24px; text-shadow: 1px 1px 0 #000;"
        data-status="æ’­æ”¾">â–¶</button>

      <div class="progress-container"
        style="flex-grow: 1; height:10px; background: rgba(255,255,255,0.3); border-radius: 5px; position: relative; cursor: pointer;">
        <div class="progress-bar" style="height: 100%; background: #00BFFF; border-radius: 5px; width: 500px;"></div>
        <img class="progress-daimao" src="images/daimaoyou.png"
          style="position: absolute; top: -50px; left: 0; width: 70px; height: 70px; transform: translateX(-50%);">
      </div>

      <span id="currentTime" style="color: #00BFFF; min-width: 50px;">0:00</span>
      <span style="color: #00BFFF;">/</span>
      <span id="duration" style="color: #00BFFF; min-width: 50px;">0:00</span>

      <button id="volumeBtn" class="tooltip" data-tooltip="éŸ³é‡æ§åˆ¶"
        style="background: none; border: none; color: #00BFFF; cursor: pointer; font-size: 20px;">ğŸ”Š</button>
      <input id="volumeSlider" type="range" min="0" max="1" step="0.1" value="1" style="width: 100px;">

      <div class="speed-control tooltip" data-tooltip="æ’­æ”¾é€Ÿåº¦" style="position: relative;">
        <span id="currentSpeed">1.0x</span>
        <div class="speed-menu">
          <div class="speed-option" data-speed="0.5">0.5x</div>
          <div class="speed-option" data-speed="1.0">1.0x</div>
          <div class="speed-option" data-speed="1.5">1.5x</div>
          <div class="speed-option" data-speed="2.0">2.0x</div>
        </div>
      </div>

      <button id="loopBtn" class="tooltip" data-tooltip="å¾ªç¯æ’­æ”¾"
        style="background: none; border: none; color: #00BFFF; cursor: pointer; font-size: 20px;">ğŸ”</button>
      <button id="saveBtn" class="tooltip" data-tooltip="ä¿å­˜è§†é¢‘"
        style="background: none; border: none; color: #00BFFF; cursor: pointer; font-size: 20px;">ğŸ’¾</button>
      <button id="closeVideo" class="tooltip" data-tooltip="å…³é—­è§†é¢‘"
        style="background: none; border: none; color: #FF4D4D; cursor: pointer; font-size: 20px;">âœ–</button>
    </div>
  </div>

  <div id="gameContainer">
    <!-- å…ˆæ”¾ç½®æ‰€æœ‰èƒŒæ™¯å›¾ç‰‡ -->
    <div class="background-container">
      <div class="background-section"></div>
      <div class="background-section"></div>
      <div class="background-section"></div>
      <div class="background-section"></div>
      <div class="background-section"></div>
      <div class="background-section"></div>
      <div class="background-section"></div>
    </div>

    <!-- ç„¶åæ˜¯å…¶ä»–UIå…ƒç´  -->
    <div id="scoreBox">å¾—åˆ†ï¼š<span id="scoreValue">0</span></div>
    <div id="timerBox">æ—¶é—´ï¼š<span id="timerValue">120</span></div>
    <button id="endGameButton">æå‰ç»“æŸ</button>
    <div id="player"></div>

    <!-- åœ¨gameContaineråé¢æ·»åŠ çŠ¶æ€æ  -->
    <div id="statusBar">
      <div class="status-icon" id="dafuStatus">
        <img src="images/dafu.png" alt="å¤§ç¦">
        <div class="tooltip">åŒå€å¾—åˆ†ï¼šæœªæ¿€æ´»</div>
      </div>
      <div class="status-icon" id="caochonggunStatus">
        <img src="images/caochonggun1.png" alt="è™«æ£">
        <div class="tooltip">äºŒæ®µè·³ï¼šæœªæ¿€æ´»</div>
      </div>
      <div class="status-icon" id="shuangdaoStatus">
        <img src="images/shuangdao1.png" alt="åŒåˆ€">
        <div class="tooltip">åŠ é€Ÿï¼šæœªæ¿€æ´»</div>
      </div>
      <div class="status-icon" id="dajianStatus">
        <img src="images/dajian1.png" alt="å¤§å‰‘">
        <div class="tooltip">å˜å¤§ï¼šæœªæ¿€æ´»</div>
      </div>
      <div class="status-icon" id="zhongnuStatus">
        <img src="images/zhongnu1.png" alt="è€é‡‘é‡å¼©">
        <div class="tooltip">å¸å–é“å…·ï¼šæœªæ¿€æ´»</div>
      </div>
      <div class="status-icon" id="taidaoStatus">
        <img src="images/taidao1.png" alt="å¤ªåˆ€">
        <div class="tooltip">å†²åˆºï¼šæœªæ¿€æ´»</div>
      </div>
    </div>

    <!-- è¿”å›æŒ‰é’® -->
    <a href="game.html" class="back-button">è¿”å›æ¸¸æˆåˆ—è¡¨</a>

    <!-- æ¸¸æˆç»“æŸå¼¹çª— -->
    <div id="gameOverModal">
      <h2>æ¸¸æˆç»“æŸï¼</h2>
      <div id="rewardVideos"></div>
      <div class="bottom-buttons">
        <a href="javascript:;" class="aki-btn" onclick="restartGame()">
          <span class="txt">é‡æ–°å¼€å§‹</span>
          <span class="icon">
            <svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M729.6 448H128v85.333333h601.6L597.333333 665.6l59.733334 59.733333 234.666666-234.666666L661.333333 256l-59.733333 59.733333 128 132.266667z">
              </path>
            </svg>
          </span>
        </a>
        <a href="javascript:;" class="aki-btn" onclick="window.location.href='game.html'">
          <span class="txt">è¿”å›èœå•</span>
          <span class="icon">
            <svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M729.6 448H128v85.333333h601.6L597.333333 665.6l59.733334 59.733333 234.666666-234.666666L661.333333 256l-59.733333 59.733333 128 132.266667z">
              </path>
            </svg>
          </span>
        </a>
      </div>
    </div>


    <!-- åœ¨ <body> æ ‡ç­¾å†…ï¼Œåœ¨ gameContainer div ä¹‹å‰æ·»åŠ ä»¥ä¸‹ä»£ç  -->
    <div id="gameRules" class="game-rules">
      <div class="rules-header">æ¸¸æˆè§„åˆ™</div>
      <div class="rules-content">
        <p class="rules-intro">æ“æ§å‘†çŒ«ï¼Œæ¥å–æ›´å¤šçš„ç¦ï¼Œä»¥æ¢å–æ›´å¤šçš„ç§¯åˆ†ï¼Œä»è€Œè§£é”æ›´å¤šæ¥è‡ªå‘†çŒ«çš„ç¦åˆ©å°è§†é¢‘å–µï¼ï¼ï¼</p>
        <p class="rules-intro">æœ¬æ¸¸æˆæ€»å…±åäºŒä¸ªç¦åˆ©å°è§†é¢‘ï¼Œè¾¾åˆ°ä¸€ç™¾ä¸‡ç§¯åˆ†å³å¯å…¨éƒ¨è§£é”å–µï¼ï¼ï¼</p>
        <div class="rules-items">
          <div class="rule-item">
            <img src="images/fu1.png" alt="å°ç¦">
            <span>å°ç¦ï¼šåŸºç¡€å¾—åˆ†20åˆ†</span>
          </div>
          <div class="rule-item">
            <img src="images/dafu.png" alt="å¤§ç¦">
            <span>å¤§ç¦ï¼šåŸºç¡€å¾—åˆ†50åˆ†ï¼Œæ¯è·å¾—ä¸€ä¸ªå¤§ç¦å¢åŠ 200%ç§¯åˆ†è·å¾—ç‡<span
                style="color: #FF4D4D;">ï¼ˆæ³¨æ„ï¼šå¤§ç¦çš„2å€ç§¯åˆ†æ•ˆæœæ˜¯å‘ˆæŒ‡æ•°å€å åŠ çš„ï¼å¦‚æœè¿ç»­è·å¾—åä¸ªå¤§ç¦ï¼Œé‚£ä¹ˆç§¯åˆ†å€ç‡æ˜¯1024å€ï¼ï¼ï¼ï¼ï¼ï¼ï¼‰</span></span>
          </div>
          <div class="rule-item">
            <img src="images/caochonggun1.png" alt="æ“è™«æ£">
            <span>æ“è™«æ£ï¼šè·å¾—15ç§’äºŒæ®µè·³èƒ½åŠ›</span>
          </div>
          <div class="rule-item">
            <img src="images/shuangdao1.png" alt="åŒåˆ€">
            <span>åŒåˆ€ï¼šè·å¾—12ç§’åŠ é€Ÿæ•ˆæœ</span>
          </div>
          <div class="rule-item">
            <img src="images/dajian1.png" alt="å¤§å‰‘">
            <span>å¤§å‰‘ï¼šè·å¾—12ç§’å˜å¤§æ•ˆæœ</span>
          </div>
          <div class="rule-item">
            <img src="images/zhongnu1.png" alt="é‡å¼©">
            <span>é‡å¼©ï¼šè·å¾—10ç§’å¸å–é“å…·æ•ˆæœ</span>
          </div>
          <div class="rule-item">
            <img src="images/taidao1.png" alt="å¤ªåˆ€">
            <span>å¤ªåˆ€ï¼šè·å¾—12ç§’å†²åˆºèƒ½åŠ›ï¼ˆåŒå‡»æ–¹å‘é”®è§¦å‘ï¼‰</span>
            <span style="color: #FF4D4D;">éå¸¸å¼ºåŠ›çš„å†²åˆºï¼ï¼ï¼</span>
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- åœ¨ music-player div ä¹‹å‰æ·»åŠ  -->
    <div class="music-hint">
      <span class="music-hint-text">è¿™é‡Œæœ‰</span>
      <span class="music-hint-text">å¥½å¬çš„</span>
      <span class="music-hint-text">éŸ³ä¹å–µ</span>
    </div>

    <!-- åŸæœ‰çš„éŸ³ä¹æ’­æ”¾å™¨ -->
    <div class="music-player">
      <img src="images/cartoon-music-player.png" alt="Music Player" class="player-image" id="playPauseButton">
      <p class="player-text">èƒŒæ™¯éŸ³ä¹</p>
      <audio id="audioPlayer" loop preload="auto">
        <source src="audio/jiefu.mp3" type="audio/mpeg">
      </audio>
    </div>

    <script>
      // æ¸¸æˆå˜é‡åˆå§‹åŒ–
      let playerPos = window.innerWidth * 3;
      let playerPosY = 88;
      const FLOOR_Y = 88;
      const baseSpeed = 3.1;
      let playerSpeed = baseSpeed;
      const baseJumpForce = 1.6;  // ä»2é™ä½åˆ°1.6 (å‡å°‘äº†1/5)
      let jumpForce = 0;
      const gravity = 0.05;
      let doubleScore = false;
      let dafuMultiplier = 1; // åˆå§‹å€ç‡ä¸º1
      let dafuCount = 0;      // å¤§ç¦æ•ˆæœå åŠ æ¬¡æ•°
      let dafuTimer = null;
      let doubleJump = false;
      let canDoubleJump = false;
      const baseSize = 100;
      let playerSize = baseSize;
      let isDajianActive = false;
      let canPressJumpAgain = true;  // æ–°å¢ï¼šç”¨äºè¿½è¸ªæ˜¯å¦å¯ä»¥å†æ¬¡æŒ‰è·³è·ƒé”®
      let canJump = true;         // æ˜¯å¦å¯ä»¥è·³è·ƒ
      let hasDoubleJump = false;  // æ˜¯å¦æœ‰äºŒæ®µè·³èƒ½åŠ›
      let doubleJumpAvailable = false;  // äºŒæ®µè·³æ˜¯å¦å¯ç”¨
      let caochonggunTimer = null;
      let taidaoTimer = null;
      let dajianTimer = null;
      let canDash = false;  // æ˜¯å¦å¯ä»¥å†²åˆº
      let isDashing = false;  // æ˜¯å¦æ­£åœ¨å†²åˆº
      let lastKeyPressTime = 0;  // ä¸Šæ¬¡æŒ‰é”®æ—¶é—´
      let lastKeyPressed = '';   // ä¸Šæ¬¡æŒ‰ä¸‹çš„é”®
      const DASH_COOLDOWN = 500;  // å†²åˆºå†·å´æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
      const DASH_DURATION = 200;  // å†²åˆºæŒç»­æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
      const DASH_SPEED = 15;     // å†²åˆºé€Ÿåº¦
      let hasAttract = false;  // æ˜¯å¦æœ‰å¸å–æ•ˆæœ
      let zhongnuTimer = null;
      const ATTRACT_SPEED = 15;      // åˆå§‹å¸å¼•é€Ÿåº¦
      const ATTACH_SPEED = 25;       // æœ€ç»ˆå¸é™„é€Ÿåº¦
      const SPEED_INCREMENT = 1.2;   // é€Ÿåº¦å¢é‡ç³»æ•°
      let startTime = Date.now();
      let endTime = 0;

      // é”®ç›˜çŠ¶æ€
      const keys = {
        left: false,
        right: false,
        up: false
      };

      // è·å–ç©å®¶å…ƒç´ 
      const player = document.getElementById('player');
      const gameContainer = document.getElementById('gameContainer');
      const scoreValue = document.getElementById('scoreValue');
      let score = 0;

      // æ·»åŠ è®¡æ—¶å™¨å˜é‡
      let timeLeft = 120;
      let gameActive = true;
      const timerValue = document.getElementById('timerValue');
      const gameOverModal = document.getElementById('gameOverModal');

      // ä¿®æ”¹å¥–åŠ±é˜ˆå€¼å’Œè§†é¢‘è·¯å¾„
      const rewardThresholds = [
        { score: 0, video: 'videos/jiefu1.mp4' },
        { score: 10, video: 'videos/jiefu2.mp4' },
        { score: 100, video: 'videos/jiefu3.mp4' },
        { score: 500, video: 'videos/jiefu4.mp4' },
        { score: 1000, video: 'videos/jiefu5.mp4' },
        { score: 5000, video: 'videos/jiefu6.mp4' },
        { score: 10000, video: 'videos/jiefu7.mp4' },
        { score: 20000, video: 'videos/jiefu8.mp4' },
        { score: 50000, video: 'videos/jiefu9.mp4' },
        { score: 100000, video: 'videos/jiefu10.mp4' },
        { score: 500000, video: 'videos/jiefu11.mp4' },
        { score: 1000000, video: 'videos/jiefu12.mp4' }
      ];

      // æ·»åŠ è°ƒè¯•æŒ‰é’®äº‹ä»¶ç›‘å¬

      // æ·»åŠ ä¸€ä¸ªæ–°çš„åŠ¨ç”»å¸§IDå˜é‡
      let animationFrameId = null;

      // æ·»åŠ ä¸€ä¸ªå˜é‡ä¿å­˜ä¸Šæ¬¡çš„éŸ³é‡å€¼
      let lastVolume = 1;

      // ä¿®æ”¹ updatePosition å‡½æ•°
      function updatePosition() {
        if (!gameActive) {
          if (animationFrameId) {
            cancelAnimationFrame(animationFrameId);
            animationFrameId = null;
          }
          return;
        }

        // ç§»åŠ¨é€»è¾‘
        if (isDashing) {
          // å†²åˆºæ—¶çš„ç§»åŠ¨
          if (lastKeyPressed === 'ArrowLeft' || lastKeyPressed === 'a') {
            playerPos -= DASH_SPEED;
            player.style.background = 'url("images/daimaozuo.png") no-repeat center/contain';
          } else if (lastKeyPressed === 'ArrowRight' || lastKeyPressed === 'd') {
            playerPos += DASH_SPEED;
            player.style.background = 'url("images/daimaoyou.png") no-repeat center/contain';
          }
        } else {
          // æ­£å¸¸ç§»åŠ¨
          if (keys.left && playerPos > 100) {
            playerPos -= playerSpeed;
            player.style.background = 'url("images/daimaozuo.png") no-repeat center/contain';
          }
          if (keys.right && playerPos < window.innerWidth * 6 - 100) {
            playerPos += playerSpeed;
            player.style.background = 'url("images/daimaoyou.png") no-repeat center/contain';
          }
        }

        // è·³è·ƒé€»è¾‘
        if (keys.up) {
          if (playerPosY === FLOOR_Y) {  // åœ¨åœ°é¢ä¸Šæ—¶å¯ä»¥è·³è·ƒ
            jumpForce = baseJumpForce;
            if (doubleJump) {
              canDoubleJump = true;  // è·å¾—è™«æ£åå¯ç”¨äºŒæ®µè·³
            }
          } else if (doubleJump && canDoubleJump) {  // åœ¨ç©ºä¸­ä¸”æœ‰äºŒæ®µè·³èƒ½åŠ›æ—¶
            jumpForce = baseJumpForce;  // äºŒæ®µè·³å’Œæ™®é€šè·³è·ƒä¸€æ ·é«˜
            canDoubleJump = false;  // ç”¨æ‰äºŒæ®µè·³
            console.log('æ‰§è¡ŒäºŒæ®µè·³ï¼');  // è°ƒè¯•ç”¨
          }
        }

        // åº”ç”¨é‡åŠ›
        if (playerPosY < FLOOR_Y || jumpForce !== 0) {
          playerPosY -= jumpForce;
          jumpForce -= gravity;
        }

        // é˜²æ­¢ä½äºåœ°æ¿
        if (playerPosY > FLOOR_Y) {
          playerPosY = FLOOR_Y;
          jumpForce = 0;
        }

        // å¸å–æ•ˆæœ
        if (hasAttract) {
          const playerRect = player.getBoundingClientRect();
          const playerCenterX = playerRect.left + playerRect.width / 2;
          const playerCenterY = playerRect.top + playerRect.height / 2;
          const ATTRACT_RANGE = playerRect.height * 2;

          document.querySelectorAll('.fu, .dafu, .caochonggun, .shuangdao, .dajian, .zhongnu, .taidao').forEach(item => {
            if (!item.collected && !item.isAttaching) {
              const itemRect = item.getBoundingClientRect();
              const itemCenterX = itemRect.left + itemRect.width / 2;
              const itemCenterY = itemRect.top + itemRect.height / 2;

              const dx = playerCenterX - itemCenterX;
              const dy = playerCenterY - itemCenterY;
              const distance = Math.sqrt(dx * dx + dy * dy);

              if (distance < ATTRACT_RANGE) {
                const left = parseFloat(item.style.left) || 0;
                const top = parseFloat(item.style.top) || 0;

                // æ ¹æ®è·ç¦»è®¡ç®—é€Ÿåº¦ï¼ˆè¶Šè¿‘è¶Šå¿«ï¼‰
                const speedMultiplier = Math.pow(SPEED_INCREMENT,
                  (ATTRACT_RANGE - distance) / 50);  // è·ç¦»è¶Šè¿‘ï¼Œé€Ÿåº¦å€æ•°è¶Šé«˜
                const currentSpeed = Math.min(ATTACH_SPEED,
                  ATTRACT_SPEED * speedMultiplier);  // é™åˆ¶æœ€å¤§é€Ÿåº¦

                // è®¡ç®—ç§»åŠ¨æ–¹å‘å’Œæ›²çº¿è·¯å¾„
                const moveX = (dx / distance) * currentSpeed;
                const moveY = (dy / distance) * currentSpeed;

                // æ·»åŠ è½»å¾®çš„æ›²çº¿è¿åŠ¨
                const curve = Math.sin(Date.now() / 200) * 2;  // è½»å¾®çš„æ­£å¼¦æ³¢åŠ¨
                const curveX = moveX + curve;
                const curveY = moveY + curve;

                // æ›´æ–°ä½ç½®
                item.style.left = (left + curveX) + 'px';
                item.style.top = (top + curveY) + 'px';
                item.style.transition = 'all 0.1s ease-out';  // æ›´å¿«çš„è¿‡æ¸¡
                item.style.zIndex = '1001';

                // å½“éå¸¸æ¥è¿‘æ—¶ï¼Œç›´æ¥å¸é™„å¹¶è§¦å‘æ”¶é›†æ•ˆæœ
                if (distance < 30) {
                  item.isAttaching = true;

                  // å¿«é€Ÿå¸é™„åŠ¨ç”»
                  item.style.position = 'fixed';
                  item.style.left = `${playerCenterX - itemRect.width / 2}px`;
                  item.style.top = `${playerCenterY - itemRect.height / 2}px`;
                  item.style.transition = 'all 0.15s cubic-bezier(0.4, 0, 0.2, 1)';
                  item.style.transform = 'scale(0.6)';
                  item.style.opacity = '0.8';

                  // æ›´çŸ­çš„æ¶ˆå¤±æ—¶é—´
                  setTimeout(() => {
                    item.style.transform = 'scale(0)';
                    item.style.opacity = '0';
                    setTimeout(() => {
                      item.collected = true;
                      item.style.display = 'none';
                      // æ ¹æ®é“å…·ç±»å‹åº”ç”¨æ•ˆæœ
                      if (item.className === 'fu') {
                        score += 20 * (doubleScore ? dafuMultiplier : 1);
                      } else if (item.className === 'dafu') {
                        score += 50;
                        dafuCount++; // å¢åŠ å¤§ç¦è®¡æ•°ï¼Œä¸è®¾ä¸Šé™
                        dafuMultiplier = Math.pow(2, dafuCount); // 2çš„næ¬¡æ–¹ä½œä¸ºå€ç‡ï¼Œå¯ä»¥æ— é™å¢é•¿
                        doubleScore = true;

                        // æ›´æ–°çŠ¶æ€æ˜¾ç¤ºï¼Œæ”¹ç”¨å€æ•°è¡¨ç¤º
                        const dafuStatus = document.getElementById('dafuStatus');
                        const tooltip = dafuStatus.querySelector('.tooltip');
                        tooltip.textContent = `${dafuMultiplier}å€åŠ æˆï¼šå‰©ä½™18ç§’`;

                        // æ¸…é™¤æ—§çš„è®¡æ—¶å™¨
                        if (dafuTimer) clearTimeout(dafuTimer);

                        // è®¾ç½®æ–°çš„è®¡æ—¶å™¨
                        updateStatus('dafuStatus', 18);
                        dafuTimer = setTimeout(() => {
                          doubleScore = false;
                          dafuCount = 0;     // é‡ç½®å¤§ç¦è®¡æ•°
                          dafuMultiplier = 1; // é‡ç½®å€ç‡
                          document.getElementById('dafuStatus').classList.remove('active');
                          dafuStatus.querySelector('.tooltip').textContent = 'åŒå€å¾—åˆ†ï¼šæœªæ¿€æ´»';
                        }, 18000);
                      } else if (item.className === 'caochonggun') {
                        doubleJump = true;
                        hasDoubleJump = true;
                        if (caochonggunTimer) clearTimeout(caochonggunTimer);
                        updateStatus('caochonggunStatus', 15);  // 15ç§’
                        caochonggunTimer = setTimeout(() => {
                          doubleJump = false;
                          hasDoubleJump = false;
                          doubleJumpAvailable = false;
                          document.getElementById('caochonggunStatus').classList.remove('active');
                        }, 15000);
                      } else if (item.className === 'shuangdao') {
                        playerSpeed = baseSpeed * 1.5;
                        if (taidaoTimer) clearTimeout(taidaoTimer);
                        updateStatus('shuangdaoStatus', 12);  // 12ç§’
                        taidaoTimer = setTimeout(() => {
                          playerSpeed = baseSpeed;
                          document.getElementById('shuangdaoStatus').classList.remove('active');
                        }, 12000);
                      } else if (item.className === 'dajian') {
                        playerSize = baseSize * 1.5;
                        player.style.width = `${playerSize}px`;
                        player.style.height = `${playerSize}px`;
                        if (dajianTimer) clearTimeout(dajianTimer);
                        updateStatus('dajianStatus', 12);  // 12ç§’
                        dajianTimer = setTimeout(() => {
                          playerSize = baseSize;
                          player.style.width = `${baseSize}px`;
                          player.style.height = `${baseSize}px`;
                          document.getElementById('dajianStatus').classList.remove('active');
                        }, 12000);
                      } else if (item.className === 'zhongnu') {
                        hasAttract = true;
                        if (zhongnuTimer) clearTimeout(zhongnuTimer);
                        updateStatus('zhongnuStatus', 10);  // 10ç§’
                        zhongnuTimer = setTimeout(() => {
                          hasAttract = false;
                          document.getElementById('zhongnuStatus').classList.remove('active');
                        }, 10000);
                      } else if (item.className === 'taidao') {
                        canDash = true;
                        if (taidaoTimer) clearTimeout(taidaoTimer);
                        updateStatus('taidaoStatus', 12);  // 12ç§’
                        taidaoTimer = setTimeout(() => {
                          canDash = false;
                          document.getElementById('taidaoStatus').classList.remove('active');
                        }, 12000);
                      }

                      scoreValue.textContent = score;
                    }, 150);
                  }, 100);
                }
              }
            }
          });
        }

        // æ£€æµ‹ç¢°æ’
        document.querySelectorAll('.fu, .dafu, .caochonggun, .shuangdao, .dajian, .zhongnu, .taidao').forEach(item => {
          if (!item.collected && isColliding(player, item)) {
            item.collected = true;
            item.style.display = 'none';

            // æ ¹æ®é“å…·ç±»å‹åº”ç”¨æ•ˆæœ
            if (item.className === 'fu') {
              score += 20 * (doubleScore ? dafuMultiplier : 1);
            } else if (item.className === 'dafu') {
              score += 50;
              dafuCount++; // å¢åŠ å¤§ç¦è®¡æ•°ï¼Œä¸è®¾ä¸Šé™
              dafuMultiplier = Math.pow(2, dafuCount); // 2çš„næ¬¡æ–¹ä½œä¸ºå€ç‡
              doubleScore = true;

              // æ›´æ–°çŠ¶æ€æ˜¾ç¤ºï¼Œæ”¹ç”¨å€æ•°è¡¨ç¤º
              const dafuStatus = document.getElementById('dafuStatus');
              const tooltip = dafuStatus.querySelector('.tooltip');
              tooltip.textContent = `${dafuMultiplier}å€åŠ æˆï¼šå‰©ä½™18ç§’`;

              // æ¸…é™¤æ—§çš„è®¡æ—¶å™¨
              if (dafuTimer) clearTimeout(dafuTimer);

              // è®¾ç½®æ–°çš„è®¡æ—¶å™¨
              updateStatus('dafuStatus', 18);
              dafuTimer = setTimeout(() => {
                doubleScore = false;
                dafuCount = 0;     // é‡ç½®å¤§ç¦è®¡æ•°
                dafuMultiplier = 1; // é‡ç½®å€ç‡
                document.getElementById('dafuStatus').classList.remove('active');
                dafuStatus.querySelector('.tooltip').textContent = 'åŒå€å¾—åˆ†ï¼šæœªæ¿€æ´»';
              }, 18000);
            } else if (item.className === 'caochonggun') {
              doubleJump = true;
              hasDoubleJump = true;
              if (caochonggunTimer) clearTimeout(caochonggunTimer);
              updateStatus('caochonggunStatus', 15);  // 15ç§’
              caochonggunTimer = setTimeout(() => {
                doubleJump = false;
                hasDoubleJump = false;
                doubleJumpAvailable = false;
                document.getElementById('caochonggunStatus').classList.remove('active');
              }, 15000);
            } else if (item.className === 'shuangdao') {
              playerSpeed = baseSpeed * 1.5;
              if (taidaoTimer) clearTimeout(taidaoTimer);
              updateStatus('shuangdaoStatus', 12);  // 12ç§’
              taidaoTimer = setTimeout(() => {
                playerSpeed = baseSpeed;
                document.getElementById('shuangdaoStatus').classList.remove('active');
              }, 12000);
            } else if (item.className === 'dajian') {
              playerSize = baseSize * 1.5;
              player.style.width = `${playerSize}px`;
              player.style.height = `${playerSize}px`;
              if (dajianTimer) clearTimeout(dajianTimer);
              updateStatus('dajianStatus', 12);  // 12ç§’
              dajianTimer = setTimeout(() => {
                playerSize = baseSize;
                player.style.width = `${baseSize}px`;
                player.style.height = `${baseSize}px`;
                document.getElementById('dajianStatus').classList.remove('active');
              }, 12000);
            } else if (item.className === 'zhongnu') {
              hasAttract = true;
              if (zhongnuTimer) clearTimeout(zhongnuTimer);
              updateStatus('zhongnuStatus', 10);  // 10ç§’
              zhongnuTimer = setTimeout(() => {
                hasAttract = false;
                document.getElementById('zhongnuStatus').classList.remove('active');
              }, 10000);
            } else if (item.className === 'taidao') {
              canDash = true;
              if (taidaoTimer) clearTimeout(taidaoTimer);
              updateStatus('taidaoStatus', 12);  // 12ç§’
              taidaoTimer = setTimeout(() => {
                canDash = false;
                document.getElementById('taidaoStatus').classList.remove('active');
              }, 12000);
            }

            scoreValue.textContent = score;
          }
        });

        // æ›´æ–°ç©å®¶ä½ç½®
        player.style.left = `${playerPos}px`;
        player.style.top = `${playerPosY}vh`;  // å§‹ç»ˆä½¿ç”¨playerPosYï¼Œç§»é™¤isDajianActiveçš„åˆ¤æ–­

        // æ·»åŠ è§†è§’è·Ÿéš
        window.scrollTo({
          left: playerPos - window.innerWidth / 2,
          behavior: 'instant'
        });

        // å­˜å‚¨åŠ¨ç”»å¸§ID
        animationFrameId = requestAnimationFrame(updatePosition);
      }

      // é”®ç›˜äº‹ä»¶ç›‘å¬
      window.addEventListener('keydown', function (e) {
        const currentTime = Date.now();

        switch (e.key) {
          case 'ArrowLeft':
          case 'a':
            if (!keys.left) { // åªåœ¨ç¬¬ä¸€æ¬¡æŒ‰ä¸‹æ—¶æ£€æŸ¥åŒå‡»
              // æ£€æŸ¥åŒå‡»
              if (canDash && !isDashing &&
                (e.key === lastKeyPressed) &&
                (currentTime - lastKeyPressTime < 300)) {  // 300mså†…çš„åŒå‡»åˆ¤å®š
                // è§¦å‘å‘å·¦å†²åˆº
                isDashing = true;
                setTimeout(() => {
                  isDashing = false;
                }, DASH_DURATION);
              }
              lastKeyPressed = e.key;
              lastKeyPressTime = currentTime;
            }
            keys.left = true;
            break;
          case 'ArrowRight':
          case 'd':
            if (!keys.right) { // åªåœ¨ç¬¬ä¸€æ¬¡æŒ‰ä¸‹æ—¶æ£€æŸ¥åŒå‡»
              // æ£€æŸ¥åŒå‡»
              if (canDash && !isDashing &&
                (e.key === lastKeyPressed) &&
                (currentTime - lastKeyPressTime < 300)) {  // 300mså†…çš„åŒå‡»åˆ¤å®š
                // è§¦å‘å‘å³å†²åˆº
                isDashing = true;
                setTimeout(() => {
                  isDashing = false;
                }, DASH_DURATION);
              }
              lastKeyPressed = e.key;
              lastKeyPressTime = currentTime;
            }
            keys.right = true;
            break;
          case 'ArrowUp':
          case 'w':
          case ' ':
            // å¦‚æœåœ¨åœ°é¢ä¸Š
            if (playerPosY === FLOOR_Y && !keys.up) {
              jumpForce = baseJumpForce;
              doubleJumpAvailable = hasDoubleJump;  // è·³è·ƒæ—¶é‡ç½®äºŒæ®µè·³å¯ç”¨æ€§
            }
            // å¦‚æœåœ¨ç©ºä¸­ä¸”å¯ä»¥äºŒæ®µè·³
            else if (playerPosY < FLOOR_Y && doubleJumpAvailable && !keys.up) {
              jumpForce = baseJumpForce;
              doubleJumpAvailable = false;  // ä½¿ç”¨æ‰äºŒæ®µè·³
              console.log('äºŒæ®µè·³ï¼');
            }
            keys.up = true;
            break;
        }
      });

      window.addEventListener('keyup', function (e) {
        switch (e.key) {
          case 'ArrowLeft':
          case 'a':
            keys.left = false;
            break;
          case 'ArrowRight':
          case 'd':
            keys.right = false;
            break;
          case 'ArrowUp':
          case 'w':
          case ' ':
            keys.up = false;
            canPressJumpAgain = true;  // æ¾å¼€è·³è·ƒé”®åæ‰èƒ½å†æ¬¡è·³è·ƒ
            break;
        }
      });

      // ç¢°æ’æ£€æµ‹å‡½æ•°
      function isColliding(player, item) {
        const playerRect = player.getBoundingClientRect();
        const itemRect = item.getBoundingClientRect();

        return !(playerRect.right < itemRect.left ||
          playerRect.left > itemRect.right ||
          playerRect.bottom < itemRect.top ||
          playerRect.top > itemRect.bottom);
      }

      // ä¿®æ”¹ç”Ÿæˆé“å…·çš„å‡½æ•°
      function generateItem() {
        const item = document.createElement('div');
        const random = Math.random();

        // è°ƒæ•´æ¦‚ç‡åˆ†é…
        if (random < 0.4) {  // 40% æ¦‚ç‡ç”Ÿæˆæ™®é€šç¦å­—
          item.className = 'fu';
        } else if (random < 0.5) {  // 10% æ¦‚ç‡ç”Ÿæˆå¤§ç¦
          item.className = 'dafu';
        } else if (random < 0.6) {  // 10% æ¦‚ç‡ç”Ÿæˆè‰è™«æ£
          item.className = 'caochonggun';
        } else if (random < 0.7) {  // 10% æ¦‚ç‡ç”ŸæˆåŒåˆ€
          item.className = 'shuangdao';
        } else if (random < 0.8) {  // 10% æ¦‚ç‡ç”Ÿæˆå¤§å‰‘
          item.className = 'dajian';
        } else if (random < 0.9) {  // 10% æ¦‚ç‡ç”Ÿæˆé‡å¼©
          item.className = 'zhongnu';
        } else {  // 10% æ¦‚ç‡ç”Ÿæˆå¤ªåˆ€
          item.className = 'taidao';
        }

        item.style.left = Math.random() * (window.innerWidth * 6) + 'px';
        gameContainer.appendChild(item);

        setTimeout(() => {
          if (item.parentNode === gameContainer) {
            gameContainer.removeChild(item);
          }
        }, 4000);
      }

      // ä¿®æ”¹å¼€å§‹ç”Ÿæˆé“å…·å‡½æ•°ï¼Œä¿å­˜interval ID
      let itemGenerationInterval;
      function startItemGeneration() {
        itemGenerationInterval = setInterval(generateItem, 200);  // ä»1000æ”¹ä¸º200ï¼Œå®ç°æ¯ç§’ç”Ÿæˆ5ä¸ªé“å…·
      }

      // åœ¨åˆå§‹åŒ–æ¸¸æˆæ—¶å¯åŠ¨è®¡æ—¶å™¨
      document.addEventListener('DOMContentLoaded', function () {
        player.style.left = `${playerPos}px`;
        player.style.top = `${playerPosY}vh`;
        gameActive = true;
        animationFrameId = requestAnimationFrame(updatePosition);
        startItemGeneration();
        updateTimer(); // å¯åŠ¨è®¡æ—¶å™¨

        // æ·»åŠ ç»“æŸæŒ‰é’®äº‹ä»¶ç›‘å¬
        document.getElementById('endGameButton').addEventListener('click', function () {
          console.log('End game button clicked'); // è°ƒè¯•ç”¨
          endGame();
        });
      });

      // ä¿®æ”¹çŠ¶æ€æ›´æ–°å‡½æ•°
      function updateStatus(statusId, duration) {
        const statusElement = document.getElementById(statusId);
        statusElement.classList.add('active');

        const tooltipElement = statusElement.querySelector('.tooltip');
        const effectName = {
          'dafuStatus': `${dafuMultiplier}å€åŠ æˆ`,  // ä¿®æ”¹ä¸ºå€æ•°æ˜¾ç¤º
          'caochonggunStatus': 'äºŒæ®µè·³',
          'shuangdaoStatus': 'åŠ é€Ÿ',
          'dajianStatus': 'å˜å¤§',
          'zhongnuStatus': 'å¸å–é“å…·',
          'taidaoStatus': 'å†²åˆº'
        }[statusId];

        function updateTooltip() {
          const timeLeft = Math.ceil((endTime - Date.now()) / 1000);
          if (timeLeft > 0) {
            tooltipElement.textContent = `${effectName}ï¼šå‰©ä½™ ${timeLeft} ç§’`;
            requestAnimationFrame(updateTooltip);
          } else {
            tooltipElement.textContent = `${effectName}ï¼šæœªæ¿€æ´»`;
          }
        }

        const endTime = Date.now() + duration * 1000;
        updateTooltip();
      }

      // æ›´æ–°è®¡æ—¶å™¨å‡½æ•°
      function updateTimer() {
        if (!gameActive) return;

        timeLeft--;
        timerValue.textContent = timeLeft;

        if (timeLeft <= 0) {
          endGame();
        } else {
          setTimeout(updateTimer, 1000);
        }
      }

      // ä¿®æ”¹æ¸¸æˆç»“æŸå‡½æ•°
      function endGame() {
        console.log('Ending game...'); // è°ƒè¯•ç”¨

        // åœæ­¢æ¸¸æˆ
        gameActive = false;

        // åœæ­¢éŸ³ä¹æ’­æ”¾å¹¶éšè—æ’­æ”¾å™¨å’Œç®­å¤´æç¤º
        const audioPlayer = document.getElementById('audioPlayer');
        const musicPlayer = document.querySelector('.music-player');
        const playerImage = document.querySelector('.player-image');
        const musicHint = document.querySelector('.music-hint'); // æ·»åŠ è¿™è¡Œ

        audioPlayer.pause();
        playerImage.classList.remove('playing');
        musicPlayer.style.display = 'none';
        musicHint.style.display = 'none'; // æ·»åŠ è¿™è¡Œ

        // æ¸…é™¤æ‰€æœ‰è®¡æ—¶å™¨
        clearInterval(itemGenerationInterval);
        if (dafuTimer) clearTimeout(dafuTimer);
        if (caochonggunTimer) clearTimeout(caochonggunTimer);
        if (taidaoTimer) clearTimeout(taidaoTimer);
        if (dajianTimer) clearTimeout(dajianTimer);
        if (zhongnuTimer) clearTimeout(zhongnuTimer);

        // éšè—UIå…ƒç´ 
        document.getElementById('scoreBox').style.display = 'none';
        document.getElementById('timerBox').style.display = 'none';
        document.getElementById('statusBar').style.display = 'none';
        document.getElementById('endGameButton').style.display = 'none';

        // æ˜¾ç¤ºæ¸¸æˆç»“æŸå¼¹çª—
        const gameOverModal = document.getElementById('gameOverModal');
        gameOverModal.style.display = 'flex';

        // ç”Ÿæˆå¥–åŠ±è§†é¢‘æŒ‰é’®
        const rewardVideosDiv = document.getElementById('rewardVideos');
        rewardVideosDiv.innerHTML = ''; // æ¸…ç©ºç°æœ‰å†…å®¹

        // æ ¹æ®åˆ†æ•°æ˜¾ç¤ºå¯ç”¨çš„è§†é¢‘
        rewardThresholds.forEach((threshold, index) => {
          if (score >= threshold.score) {
            const button = document.createElement('a');
            button.href = 'javascript:;';
            button.className = 'aki-btn';
            button.innerHTML = `
              <span class="txt">å¥–åŠ±è§†é¢‘ ${index + 1}</span>
              <span class="icon">
                <svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
                  <path d="M729.6 448H128v85.333333h601.6L597.333333 665.6l59.733334 59.733333 234.666666-234.666666L661.333333 256l-59.733333 59.733333 128 132.266667z"></path>
                </svg>
              </span>
            `;
            button.onclick = () => playVideo(threshold.video);

            const progressText = document.createElement('div');
            progressText.className = 'progress-text';
            progressText.textContent = `è¾¾æˆåˆ†æ•°ï¼š${threshold.score}`;

            const buttonContainer = document.createElement('div');
            buttonContainer.appendChild(button);
            buttonContainer.appendChild(progressText);

            rewardVideosDiv.appendChild(buttonContainer);
          }
        });
      }

      // æ·»åŠ è§†é¢‘æ’­æ”¾å™¨æ§åˆ¶ä»£ç 
      document.addEventListener('DOMContentLoaded', function () {
        const videoContainer = document.getElementById('rewardVideoContainer');
        const video = document.getElementById('rewardVideo');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const progressContainer = document.querySelector('.progress-container');
        const progressBar = document.querySelector('.progress-bar');
        const currentTimeSpan = document.getElementById('currentTime');
        const durationSpan = document.getElementById('duration');
        const volumeBtn = document.getElementById('volumeBtn');
        const volumeSlider = document.getElementById('volumeSlider');
        const speedControl = document.querySelector('.speed-control');
        const speedMenu = document.querySelector('.speed-menu');
        const currentSpeed = document.getElementById('currentSpeed');
        const loopBtn = document.getElementById('loopBtn');
        const saveBtn = document.getElementById('saveBtn');
        const closeVideo = document.getElementById('closeVideo');

        let isDragging = false;

        // æ’­æ”¾/æš‚åœæ§åˆ¶
        playPauseBtn.addEventListener('click', togglePlay);

        function togglePlay() {
          if (video.paused) {
            video.play().then(() => {
              playPauseBtn.textContent = 'â¸';
              playPauseBtn.setAttribute('data-status', 'æš‚åœ');
            });
          } else {
            video.pause();
            playPauseBtn.textContent = 'â–¶';
            playPauseBtn.setAttribute('data-status', 'æ’­æ”¾');
          }
        }

        // æ ¼å¼åŒ–æ—¶é—´æ˜¾ç¤ºå‡½æ•°
        function formatTime(seconds) {
          if (isNaN(seconds)) return "0:00";  // å¤„ç† NaN æƒ…å†µ
          const minutes = Math.floor(seconds / 60);
          seconds = Math.floor(seconds % 60);
          return `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        // ä¿®æ”¹è§†é¢‘æ—¶é—´æ›´æ–°å¤„ç†å‡½æ•°
        video.ontimeupdate = () => {
          if (!isDragging) {
            // ä½¿ç”¨ requestAnimationFrame å®ç°æ›´å¹³æ»‘çš„æ›´æ–°
            requestAnimationFrame(() => {
              const progress = (video.currentTime / video.duration) * 100;

              // æ›´æ–°è¿›åº¦æ¡
              progressBar.style.width = `${progress}%`;

              // æ›´æ–°å‘†çŒ«ä½ç½®
              const daimao = document.querySelector('.progress-daimao');
              daimao.style.left = `${progress}%`;

              // æ›´æ–°æ—¶é—´æ˜¾ç¤º
              currentTimeSpan.textContent = formatTime(video.currentTime);
              durationSpan.textContent = formatTime(video.duration);
            });
          }
        };

        // ä¼˜åŒ–è¿›åº¦æ¡æ‹–åŠ¨æ›´æ–°é€»è¾‘
        function updateProgress(e) {
          const rect = progressContainer.getBoundingClientRect();
          const clickPosition = e.clientX - rect.left;
          const totalWidth = rect.width;
          const progress = Math.max(0, Math.min(clickPosition / totalWidth, 1));
          const progressPercent = progress * 100;

          // ä½¿ç”¨ requestAnimationFrame å®ç°æ›´å¹³æ»‘çš„æ›´æ–°
          requestAnimationFrame(() => {
            // æ›´æ–°è§†é¢‘æ—¶é—´
            video.currentTime = progress * video.duration;

            // æ›´æ–°è¿›åº¦æ¡
            progressBar.style.width = `${progressPercent}%`;

            // æ›´æ–°å‘†çŒ«ä½ç½®
            const daimao = document.querySelector('.progress-daimao');
            daimao.style.left = `${progressPercent}%`;
          });
        }

        // ä¼˜åŒ–æ‹–åŠ¨äº‹ä»¶å¤„ç†
        let lastDragTime = 0;
        const DRAG_THROTTLE = 16.67; // çº¦60fps

        progressContainer.addEventListener('mousemove', (e) => {
          if (isDragging) {
            const currentTime = Date.now();
            // æ·»åŠ èŠ‚æµï¼Œé¿å…è¿‡äºé¢‘ç¹çš„æ›´æ–°
            if (currentTime - lastDragTime >= DRAG_THROTTLE) {
              updateProgress(e);
              lastDragTime = currentTime;
            }
          }
        });

        // æ·»åŠ æ‹–åŠ¨äº‹ä»¶ç›‘å¬
        progressContainer.addEventListener('mousedown', (e) => {
          isDragging = true;
          updateProgress(e);
        });

        document.addEventListener('mouseup', () => {
          isDragging = false;
        });

        // å€é€Ÿæ§åˆ¶
        currentSpeed.addEventListener('click', (e) => {
          e.stopPropagation();
          speedMenu.style.display = speedMenu.style.display === 'none' ? 'block' : 'none';
        });

        document.querySelectorAll('.speed-option').forEach(option => {
          option.addEventListener('click', function (e) {
            e.stopPropagation();
            const speed = parseFloat(this.dataset.speed);
            video.playbackRate = speed;
            currentSpeed.textContent = speed + 'x';
            speedMenu.style.display = 'none';
          });
        });

        // ç‚¹å‡»å…¶ä»–åœ°æ–¹æ—¶éšè—é€Ÿåº¦èœå•
        document.addEventListener('click', () => {
          speedMenu.style.display = 'none';
        });

        // å¾ªç¯æ’­æ”¾æ§åˆ¶
        let isLooping = false;
        loopBtn.addEventListener('click', () => {
          isLooping = !isLooping;
          video.loop = isLooping;
          loopBtn.style.color = isLooping ? '#00BFFF' : '#666666';
          loopBtn.style.opacity = isLooping ? '1' : '0.6';
          loopBtn.setAttribute('data-tooltip', `å¾ªç¯æ’­æ”¾ï¼š${isLooping ? 'å¼€å¯' : 'å…³é—­'}`);
        });

        // ä¿å­˜è§†é¢‘åŠŸèƒ½
        saveBtn.addEventListener('click', () => {
          const videoUrl = video.querySelector('source').src;
          const a = document.createElement('a');
          a.href = videoUrl;
          a.download = videoUrl.split('/').pop();
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
        });

        // å…³é—­è§†é¢‘
        closeVideo.addEventListener('click', () => {
          video.pause();
          videoContainer.style.display = 'none';

          // å¦‚æœå›åˆ°æ¸¸æˆé¡µé¢æ‰æ˜¾ç¤ºUI
          if (gameActive) {
            document.getElementById('scoreBox').style.display = '';
            document.getElementById('timerBox').style.display = '';
            document.getElementById('statusBar').style.display = '';
            document.getElementById('endGameButton').style.display = '';
          }
        });

        // è§†é¢‘åŠ è½½å®Œæˆåæ˜¾ç¤ºæ€»æ—¶é•¿
        video.onloadedmetadata = () => {
          durationSpan.textContent = formatTime(video.duration);

          // åˆå§‹åŒ–æ’­æ”¾é€Ÿåº¦
          video.playbackRate = 1.0;
          currentSpeed.textContent = '1.0x';

          // ä¿®æ”¹ï¼šé»˜è®¤å¼€å¯å¾ªç¯æ’­æ”¾
          video.loop = true;
          isLooping = true;
          loopBtn.style.color = '#00BFFF';
          loopBtn.setAttribute('data-tooltip', 'å¾ªç¯æ’­æ”¾ï¼šå¼€å¯');

          // åˆå§‹åŒ–éŸ³é‡
          video.volume = volumeSlider.value;
          volumeBtn.dataset.tooltip = `éŸ³é‡ï¼š${Math.round(volumeSlider.value * 100)}%`;
        };

        // ç‚¹å‡»è§†é¢‘åˆ‡æ¢æ’­æ”¾/æš‚åœ
        video.addEventListener('click', togglePlay);

        // é˜²æ­¢ç‚¹å‡»æ§åˆ¶æ æ—¶è§¦å‘è§†é¢‘æ’­æ”¾/æš‚åœ
        document.querySelector('.custom-controls').addEventListener('click', (e) => {
          e.stopPropagation();
        });
      });

      // ä¿®æ”¹é‡æ–°å¼€å§‹æ¸¸æˆçš„å‡½æ•°
      function restartGame() {
        // éšè—æ¸¸æˆç»“æŸå¼¹çª—
        const gameOverModal = document.getElementById('gameOverModal');
        gameOverModal.style.display = 'none';

        // é‡æ–°æ˜¾ç¤ºUIå…ƒç´ 
        document.getElementById('scoreBox').style.display = '';
        document.getElementById('timerBox').style.display = '';
        document.getElementById('statusBar').style.display = '';
        document.getElementById('endGameButton').style.display = '';

        // ç¡®ä¿å–æ¶ˆä¹‹å‰çš„åŠ¨ç”»å¾ªç¯
        if (animationFrameId) {
          cancelAnimationFrame(animationFrameId);
          animationFrameId = null;
        }

        // é‡ç½®æ¸¸æˆçŠ¶æ€
        gameActive = true;

        // é‡ç½®é”®ç›˜çŠ¶æ€
        keys.left = false;
        keys.right = false;
        keys.up = false;

        // é‡ç½®åˆ†æ•°
        score = 0;
        scoreValue.textContent = score;

        // é‡ç½®è®¡æ—¶å™¨
        timeLeft = 120;
        timerValue.textContent = timeLeft;

        // é‡ç½®ç©å®¶ä½ç½®å’ŒçŠ¶æ€
        playerPos = window.innerWidth * 3;
        playerPosY = 88;
        playerSize = baseSize;
        jumpForce = 0;
        player.style.width = `${baseSize}px`;
        player.style.height = `${baseSize}px`;
        player.style.left = `${playerPos}px`;
        player.style.top = `${playerPosY}vh`;

        // é‡ç½®æ‰€æœ‰å¢ç›ŠçŠ¶æ€
        doubleScore = false;
        dafuCount = 0;
        dafuMultiplier = 1;
        doubleJump = false;
        hasDoubleJump = false;
        canDoubleJump = false;
        playerSpeed = baseSpeed;
        hasAttract = false;
        canDash = false;
        isDashing = false;

        // æ¸…é™¤æ‰€æœ‰è®¡æ—¶å™¨
        if (dafuTimer) clearTimeout(dafuTimer);
        if (caochonggunTimer) clearTimeout(caochonggunTimer);
        if (taidaoTimer) clearTimeout(taidaoTimer);
        if (dajianTimer) clearTimeout(dajianTimer);
        if (zhongnuTimer) clearTimeout(zhongnuTimer);

        // é‡ç½®æ‰€æœ‰çŠ¶æ€å›¾æ ‡
        document.querySelectorAll('.status-icon').forEach(status => {
          status.classList.remove('active');
          const tooltip = status.querySelector('.tooltip');
          const effectName = tooltip.textContent.split('ï¼š')[0];
          tooltip.textContent = `${effectName}ï¼šæœªæ¿€æ´»`;
        });

        // æ¸…é™¤æ‰€æœ‰ç°æœ‰é“å…·
        document.querySelectorAll('.fu, .dafu, .caochonggun, .shuangdao, .dajian, .zhongnu, .taidao').forEach(item => {
          if (item.parentNode === gameContainer) {
            gameContainer.removeChild(item);
          }
        });

        // é‡æ–°å¼€å§‹ç”Ÿæˆé“å…·
        if (itemGenerationInterval) clearInterval(itemGenerationInterval);
        startItemGeneration();

        // é‡æ–°å¯åŠ¨æ¸¸æˆå¾ªç¯
        animationFrameId = requestAnimationFrame(updatePosition);

        // é‡æ–°å¼€å§‹è®¡æ—¶å™¨
        updateTimer();

        // é‡æ–°æ˜¾ç¤ºå¹¶æ’­æ”¾éŸ³ä¹
        const audioPlayer = document.getElementById('audioPlayer');
        const musicPlayer = document.querySelector('.music-player');
        const playerImage = document.querySelector('.player-image');
        const musicHint = document.querySelector('.music-hint'); // æ·»åŠ è¿™è¡Œ

        musicPlayer.style.display = '';
        musicHint.style.display = ''; // æ·»åŠ è¿™è¡Œ
        audioPlayer.play().then(() => {
          playerImage.classList.add('playing');
          playerImage.style.setProperty('--rotation', '0deg');
        });
      }

      // åœ¨å…¶ä»–JavaScriptä»£ç ä¹‹å‰æ·»åŠ è§†é¢‘æ’­æ”¾å‡½æ•°
      function playVideo(videoUrl) {
        const videoContainer = document.getElementById('rewardVideoContainer');
        const video = document.getElementById('rewardVideo');
        const source = video.querySelector('source');
        const volumeBtn = document.getElementById('volumeBtn');
        const volumeSlider = document.getElementById('volumeSlider');
        let lastVolume = 1;

        // è®¾ç½®è§†é¢‘æº
        source.src = videoUrl;
        video.load();

        // æ˜¾ç¤ºè§†é¢‘å®¹å™¨
        videoContainer.style.display = 'block';

        // éšè—æ¸¸æˆUI
        document.getElementById('scoreBox').style.display = 'none';
        document.getElementById('timerBox').style.display = 'none';
        document.getElementById('statusBar').style.display = 'none';
        document.getElementById('endGameButton').style.display = 'none';

        // åˆå§‹åŒ–éŸ³é‡æ§åˆ¶
        video.volume = volumeSlider.value;
        volumeBtn.setAttribute('data-tooltip', `éŸ³é‡ï¼š${Math.round(volumeSlider.value * 100)}%`);

        // éŸ³é‡æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        volumeBtn.onclick = () => {
          if (video.volume > 0) {
            lastVolume = video.volume;
            video.volume = 0;
            volumeSlider.value = 0;
            volumeBtn.textContent = 'ğŸ”‡';
            volumeBtn.setAttribute('data-tooltip', 'éŸ³é‡ï¼š0%');
          } else {
            video.volume = lastVolume;
            volumeSlider.value = lastVolume;
            volumeBtn.textContent = 'ğŸ”Š';
            volumeBtn.setAttribute('data-tooltip', `éŸ³é‡ï¼š${Math.round(lastVolume * 100)}%`);
          }
        };

        // éŸ³é‡æ»‘å—äº‹ä»¶
        volumeSlider.oninput = () => {
          const volume = parseFloat(volumeSlider.value);
          video.volume = volume;
          volumeBtn.textContent = volume > 0 ? 'ğŸ”Š' : 'ğŸ”‡';
          volumeBtn.setAttribute('data-tooltip', `éŸ³é‡ï¼š${Math.round(volume * 100)}%`);
          if (volume > 0) {
            lastVolume = volume;
          }
        };

        // æ’­æ”¾è§†é¢‘
        video.play().then(() => {
          document.getElementById('playPauseBtn').textContent = 'â¸';
          document.getElementById('playPauseBtn').setAttribute('data-status', 'æš‚åœ');
        }).catch(error => {
          console.error('è§†é¢‘æ’­æ”¾å¤±è´¥:', error);
        });
      }

      // æ·»åŠ åŠ¨æ€æ›´æ–° tooltip çš„å‡½æ•°
      function updateTooltips() {
        // æ›´æ–°æ’­æ”¾/æš‚åœæŒ‰é’®çš„æç¤º
        const playPauseBtn = document.getElementById('playPauseBtn');
        playPauseBtn.dataset.tooltip = `å½“å‰çŠ¶æ€ï¼š${playPauseBtn.dataset.status}`;

        // æ›´æ–°éŸ³é‡æŒ‰é’®çš„æç¤º
        const volumeBtn = document.getElementById('volumeBtn');
        const volumeSlider = document.getElementById('volumeSlider');
        volumeBtn.dataset.tooltip = `éŸ³é‡ï¼š${Math.round(volumeSlider.value * 100)}%`;

        // æ›´æ–°é€Ÿåº¦æŒ‰é’®çš„æç¤º
        const speedBtn = document.getElementById('currentSpeed');
        speedBtn.dataset.tooltip = `å½“å‰é€Ÿåº¦ï¼š${video.playbackRate}x`;

        // æ›´æ–°å¾ªç¯æ’­æ”¾æŒ‰é’®çš„æç¤º
        const loopStatus = video.loop ? 'å¼€å¯' : 'å…³é—­';
        loopBtn.dataset.tooltip = `å¾ªç¯æ’­æ”¾ï¼š${loopStatus}`;
      }

      // åœ¨ç›¸å…³äº‹ä»¶å¤„ç†å™¨ä¸­è°ƒç”¨ updateTooltips
      document.getElementById('volumeSlider').addEventListener('input', updateTooltips);
      document.getElementById('playPauseBtn').addEventListener('click', updateTooltips);
      document.getElementById('currentSpeed').addEventListener('click', updateTooltips);
      document.getElementById('loopBtn').addEventListener('click', updateTooltips);

      // åˆå§‹åŒ– tooltips
      updateTooltips();

      // è·å–å½“å‰æ—‹è½¬è§’åº¦çš„å‡½æ•°
      function getComputedRotation(element) {
        const style = window.getComputedStyle(element);
        const transform = style.transform;

        if (transform === 'none') {
          return 0;
        }

        const values = transform.split('(')[1].split(')')[0].split(',');
        const a = values[0];
        const b = values[1];
        let angle = Math.round(Math.atan2(b, a) * (180 / Math.PI));

        if (angle < 0) {
          angle += 360;
        }

        return angle;
      }

      // è®¾ç½®éŸ³é¢‘æ§åˆ¶
      function setupAudioControl(audio, button) {
        // åˆå§‹åŒ–æ—‹è½¬è§’åº¦
        button.style.setProperty('--rotation', '0deg');

        button.addEventListener('click', function () {
          if (audio.paused) {
            audio.play().then(() => {
              const currentRotation = getComputedRotation(button);
              button.style.setProperty('--rotation', `${currentRotation}deg`);
              button.classList.add('playing');
            }).catch(error => {
              console.error('æ’­æ”¾å¤±è´¥:', error);
            });
          } else {
            audio.pause();
            button.classList.remove('playing');
            const currentRotation = getComputedRotation(button);
            button.style.setProperty('--rotation', `${currentRotation}deg`);
          }
        });

        audio.addEventListener('ended', function () {
          if (!audio.loop) {
            button.classList.remove('playing');
            const currentRotation = getComputedRotation(button);
            button.style.setProperty('--rotation', `${currentRotation}deg`);
          }
        });
      }

      // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–éŸ³é¢‘æ§åˆ¶
      document.addEventListener('DOMContentLoaded', function () {
        const audioPlayer = document.getElementById('audioPlayer');
        const playPauseButton = document.getElementById('playPauseButton');

        if (audioPlayer && playPauseButton) {
          setupAudioControl(audioPlayer, playPauseButton);
          // è‡ªåŠ¨æ’­æ”¾éŸ³ä¹
          audioPlayer.play().then(() => {
            playPauseButton.classList.add('playing');
          }).catch(error => {
            console.error('è‡ªåŠ¨æ’­æ”¾å¤±è´¥:', error);
          });
        }
      });
    </script>

    <!-- åœ¨ </body> æ ‡ç­¾ä¹‹å‰ï¼Œåœ¨å…¶ä»–è„šæœ¬ä¹‹åæ·»åŠ è¿™ä¸ªæ–°çš„ script æ ‡ç­¾ -->
    <script>
      // éŸ³ä¹æ’­æ”¾å™¨æ§åˆ¶
      document.addEventListener('DOMContentLoaded', function () {
        const audioPlayer = document.getElementById('audioPlayer');
        const playPauseButton = document.getElementById('playPauseButton');

        function getComputedRotation(element) {
          const style = window.getComputedStyle(element);
          const transform = style.transform;

          if (transform === 'none') {
            return 0;
          }

          const values = transform.split('(')[1].split(')')[0].split(',');
          const a = values[0];
          const b = values[1];
          let angle = Math.round(Math.atan2(b, a) * (180 / Math.PI));

          if (angle < 0) {
            angle += 360;
          }

          return angle;
        }

        if (audioPlayer && playPauseButton) {
          // åˆå§‹åŒ–æ—‹è½¬è§’åº¦
          playPauseButton.style.setProperty('--rotation', '0deg');

          playPauseButton.addEventListener('click', function () {
            console.log('Button clicked'); // è°ƒè¯•æ—¥å¿—
            if (audioPlayer.paused) {
              audioPlayer.play().then(() => {
                const currentRotation = getComputedRotation(playPauseButton);
                playPauseButton.style.setProperty('--rotation', `${currentRotation}deg`);
                playPauseButton.classList.add('playing');
                console.log('Audio started playing'); // è°ƒè¯•æ—¥å¿—
              }).catch(error => {
                console.error('æ’­æ”¾å¤±è´¥:', error);
              });
            } else {
              audioPlayer.pause();
              playPauseButton.classList.remove('playing');
              const currentRotation = getComputedRotation(playPauseButton);
              playPauseButton.style.setProperty('--rotation', `${currentRotation}deg`);
              console.log('Audio paused'); // è°ƒè¯•æ—¥å¿—
            }
          });

          // è‡ªåŠ¨æ’­æ”¾éŸ³ä¹
          audioPlayer.play().then(() => {
            playPauseButton.classList.add('playing');
            console.log('Auto-play started'); // è°ƒè¯•æ—¥å¿—
          }).catch(error => {
            console.error('è‡ªåŠ¨æ’­æ”¾å¤±è´¥:', error);
          });
        }
      });
    </script>
</body>

</html>